<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataFond - DashBoard</title>
    <link rel="stylesheet" href="../css/style-dash.css">
    <link rel="shortcut icon" href="assets/icon/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../js/funcoes.js"></script>
</head>

<body onload="validarSessao(), carregarGrafico()">
    <header>
        <nav>
            <div class="container-nav">
                <a href="index.html"><img class="logo" src="../assets/logo-nav.png" alt="Logo DataFound" /></a>
                <ul>
                    <div class="box_user">
                        <li><span id="welcome"></span></li>
                        <img class="img_user" src="../assets/user.svg" />
                    </div>
                        <button onclick="limparSessao()" class="btnExit">Sair</button>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <div class="container">
        <div class="kpi_container">
            <div class="data_menu">
                <h2>Indicadores</h2>
                <div class="box_menu">
                    <div class="card_menu">
                        <div class="box_kpi">
                            <span class="kpiTitle">Setor mais visitado (Dia): </span>
                            <span class="kpiText">Moda</span>
                        </div>
                        <hr class="barra">
                        <div class="box_kpi">
                            <span class="kpiTitle">Quantidade de pessoas: </span>
                            <span class="kpiText">(200 pessoas)</span>
                        </div>
                        <hr class="barra">
                        <div class="box_kpi">
                            <span class="kpiTitle">Data e hora: </span>
                            <span class="kpiText">12/04/2022 - 18:00</span>
                        </div>
                    </div>

                    <div class="card_menu">
                        <div class="box_kpi">
                            <span class="kpiTitle">Setor menos visitado (Dia): </span>
                            <span class="kpiText">Camas</span>
                        </div>
                        <hr class="barra">
                        <div class="box_kpi">
                            <span class="kpiTitle">Quantidade de pessoas: </span>
                            <span class="kpiText">(50 pessoas)</span>
                        </div>
                        <hr class="barra">
                        <div class="box_kpi">
                            <span class="kpiTitle">Data e hora: </span>
                            <span class="kpiText">12/04/2022 - 18:00</span>
                        </div>
                    </div>
                    <div class="card_menu">
                        <div class="box_kpi">
                            <span class="kpiTitle">Horario de pico (Dia): </span>
                            <span class="kpiText">12:00</span>
                        </div>
                        <hr class="barra">
                        <div class="box_kpi">
                            <span class="kpiTitle">Quantidade de pessoas: </span>
                            <span class="kpiText">(150 pessoas)</span>
                        </div>
                        <hr class="barra">
                        <div class="box_kpi">
                            <span class="kpiTitle">Data: </span>
                            <span class="kpiText">12/04/2022</span>
                        </div>

                    </div>
                </div>
            </div>
            <div class="containerAll">
                <div class="title_fluxo">
                    <h3>Fluxo de pessoas nos setores</h3>
                    <span class="daily">- Diário -</span>
                </div>
                <div class="container_cards">
                    <div class="box_metricasCards">
                        <div class="box_metricas">
                            <div class="metricas perigo">
                                <span>Perigo</span>
                                <span>Pouco fluxo 15%</span>
                            </div>
                            <div class="metricas atencao">
                                <span>Atenção</span>
                                <span>Pouco fluxo 25%</span>
                            </div>
                            <div class="metricas ideal">
                                <span>Fluxo Ideal 50%</span>
                            </div>
                            <div class="metricas atencao">
                                <span>Atenção</span>
                                <span>Superlotação 75%</span>
                            </div>
                            <div class="metricas perigo">
                                <span>Perigo</span>
                                <span>Superlotação 90%</span>
                            </div>
                        </div>
                        <div class="box_card">
                            <a href="dat-acqu-ino/index.html">
                                <div class="card">
                                    <span class="title_setor">Eletrônicos</span>
                                    <span class="text_setor">Fluxo no setor: 10</span>
                                    <span class="text_setor">Máx: 11</span>
                                    <span class="text_setor_fluxoPercent">Fluxo: 95%</span>
                                    <img src="../assets/exclamationRed.svg" alt="">
                                </div>
                            </a>
                            <div class="card">
                                <span class="title_setor">Vestuário</span>
                                <span class="text_setor">Fluxo no setor: 8</span>
                                <span class="text_setor">Máx: 11</span>
                                <span class="text_setor_fluxoPercent">Fluxo: 80%</span>
                                <img src="../assets/exclamationYellow.svg" alt="">
                            </div>
                            <div class="card">
                                <span class="title_setor">Brinquedos</span>
                                <span class="text_setor">Fluxo no setor: 5</span>
                                <span class="text_setor">Máx: 12</span>
                                <span class="text_setor_fluxoPercent">Fluxo: 80%</span>
                                <img src="../assets/correct.svg" alt="">
                            </div>
                            <div class="card">
                                <span class="title_setor">Cosméticos</span>
                                <span class="text_setor">Fluxo no setor: 14</span>
                                <span class="text_setor">Máx: 15</span>
                                <span class="text_setor_fluxoPercent">Fluxo: 95%</span>
                                <img src="../assets/exclamationRed.svg" alt="">
                            </div>
                            <div class="card">
                                <span class="title_setor">Alimentício</span>
                                <span class="text_setor">Fluxo no setor: 10</span>
                                <span class="text_setor">Máx: 15</span>
                                <span class="text_setor_fluxoPercent">Fluxo: 75%</span>
                                <img src="../assets/exclamationYellow.svg" alt="">
                            </div>
                            <div class="card">
                                <span class="title_setor">Moda</span>
                                <span class="text_setor">Fluxo no setor: 5</span>
                                <span class="text_setor">Máx: 15</span>
                                <span class="text_setor_fluxoPercent">Fluxo: 48%</span>
                                <img src="../assets/correct.svg" alt="">
                            </div>
                            <div class="card">
                                <span class="title_setor">Higiene</span>
                                <span class="text_setor">Fluxo no setor: 14</span>
                                <span class="text_setor">Máx: 15</span>
                                <span class="text_setor_fluxoPercent">Fluxo: 97%</span>
                                <img src="../assets/exclamationRed.svg" alt="">
                            </div>
                            <div class="card">
                                <span class="title_setor">Bebidas</span>
                                <span class="text_setor">Fluxo no setor: 10</span>
                                <span class="text_setor">Máx: 15</span>
                                <span class="text_setor_fluxoPercent">Fluxo: 76%</span>
                                <img src="../assets/exclamationYellow.svg" alt="">
                            </div>
                            <div class="card">
                                <span class="title_setor">Eletrodomésticos</span>
                                <span class="text_setor">Fluxo no setor: 5</span>
                                <span class="text_setor">Máx: 15</span>
                                <span class="text_setor_fluxoPercent">Fluxo: 45%</span>
                                <img src="../assets/correct.svg" alt="">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div class="boxes graf-pizza">
                    <canvas id="setor" width="800" height="1250"></canvas>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <div><a href="../downloadApi/dat-acqui-ino-datafound-main.zip" download="Sistema-DataFound">! Baixar o sistema DataFound </a></div>
    </footer>
</body>

</html>
<script>
    var idUsuario = sessionStorage.ID_USUARIO;
    welcome.innerHTML = sessionStorage.NOME_USUARIO;

    function carregarGrafico() {
        fetch(`/fluxo/listar/${idUsuario}`, {
            method: "GET",
            headers: {
                "Content-Type": "application/json"
            },
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                resposta.json().then(json => {
                    console.log(json);
                    console.log(JSON.stringify(json));


                });

            } else {
                throw ("Houve um erro ao tentar realizar a listagem!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
    }

    // INÍCIO DO GRÁFICO DE PIZZA - FLUXO DE DEPARTAMENTO
    const ctxFluxo = document.getElementById('setor');
    const chartFluxo = new Chart("setor", {
        type: "pie",
        data: {
            labels: ["Eletrônicos", "Vestuário", "Brinquedos", "Cosméticos", "Alimentício"],
            datasets: [{
                backgroundColor: ["#b91d47",
                    "#00aba9",
                    "#2b5797",
                    "#e8c3b9",
                    "#1e7145"],
                data: [55, 49, 44, 24, 15]
            }]
        },
        options: {
            title: {
                display: true,
                text: "Fluxo de pessoas (Tempo real)"
            }
        }
    });
  

    // FIM DO GRÁFICO DE PIZZA - FLUXO DE DEPARTAMENTO

    // INÍCIO DO GRÁFICO DE LINHA - ENTRADA DE PESSOAS
    // const ctxEntrada = document.getElementById('entrada');
    // const chartEntrada = new Chart(ctxEntrada, {
    //     type: 'line',
    //     data: {
    //         labels: ["Eletrônicos", "Vestuário", "Brinquedos", "Cosméticos", "Alimentício"],
    //         datasets: [{
    //             label: 'Entrada de pessoas',
    //             data: [12, 19, 3, 5, 2],
    //             backgroundColor: [
    //                 'rgba(255, 99, 132, 0.2)',
    //                 'rgba(54, 162, 235, 0.2)',
    //                 'rgba(255, 206, 86, 0.2)',
    //                 'rgba(75, 192, 192, 0.2)',
    //                 'rgba(153, 102, 255, 0.2)',
    //                 'rgba(255, 159, 64, 0.2)'
    //             ],
    //             borderColor: [
    //                 'rgba(255, 99, 132, 1)',
    //                 'rgba(54, 162, 235, 1)',
    //                 'rgba(255, 206, 86, 1)',
    //                 'rgba(75, 192, 192, 1)',
    //                 'rgba(153, 102, 255, 1)',
    //                 'rgba(255, 159, 64, 1)'
    //             ],
    //             borderWidth: 1
    //         }]
    //     },
    //     options: {
    //         scales: {
    //             y: {
    //                 beginAtZero: true
    //             }
    //         }
    //     }
    // });
    // FIM DO GRÁFICO DE LINHA - ENTRADA DE PESSOAS

    // INÍCIO DO GRÁFICO DE BARRA - PRODUTOS DE SETORES
    // const ctxProdutos = document.getElementById('produtos');
    // const charProdutos = new Chart(ctxProdutos, {
    //     type: 'bar',
    //     data: {
    //         labels: ['Notebook', 'Mouse', 'Teclado', 'Headset', 'Microfone', 'Mouse pad'],
    //         datasets: [{
    //             label: 'Produtos mais requisitados - Setor de eletrônicos',
    //             data: [12, 19, 3, 5, 2, 3],
    //             backgroundColor: [
    //                 'rgba(255, 99, 132, 0.2)',
    //                 'rgba(54, 162, 235, 0.2)',
    //                 'rgba(255, 206, 86, 0.2)',
    //                 'rgba(75, 192, 192, 0.2)',
    //                 'rgba(153, 102, 255, 0.2)',
    //                 'rgba(255, 159, 64, 0.2)'
    //             ],
    //             borderColor: [
    //                 'rgba(255, 99, 132, 1)',
    //                 'rgba(54, 162, 235, 1)',
    //                 'rgba(255, 206, 86, 1)',
    //                 'rgba(75, 192, 192, 1)',
    //                 'rgba(153, 102, 255, 1)',
    //                 'rgba(255, 159, 64, 1)'
    //             ],
    //             borderWidth: 1
    //         }]
    //     },
    //     options: {
    //         scales: {
    //             y: {
    //                 beginAtZero: true
    //             }
    //         }
    //     }
    // });
// FIM DO GRÁFICO DE BARRA - PRODUTOS DE SETORES
</script>